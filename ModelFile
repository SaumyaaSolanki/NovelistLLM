
from langchain_ollama import ChatOllama
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
from langchain_community.tools import DuckDuckGoSearchRun

model = ChatOllama(model="novelistllm")
prompt = ChatPromptTemplate.from_messages([""])
parser = StrOutputParser()
search = DuckDuckGoSearchRun()

chain = prompt | model | parser

def generate_response(userText):
    context = search.invoke(f"Who is {userText}")
    response = chain.invoke({"question": f"Summarize information about {userText}","context":context})
    return response

def write_to_file(userText, information, i):
    file_name = "output.txt"
    try:
        with open(file_name, 'Novelist_LLM') as file:
            file.write(str(i)+") Who is " + userText + "\n")
            file.write(information)
            file.write("\n")
        print(f"Content successfully appended to {file_name}")
    except IOError as e:
        print(f"An error occurred: {e}")

count = 1
userInput = ("Would you like your character to be based on a specific historical figure or fantasy archetype?")
while userInput.lower() != "exit":
    info = generate_response(userInput)
    write_to_file(userInput, info, count)
    count += 1
    userInput = input("Enter another historical figure or fantasy archetype to create a character (or type 'exit' to quit): ")

# Each line explained in 2 sentences -